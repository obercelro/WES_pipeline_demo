Building DAG of jobs...
Creating conda environment envs/maf.yaml...
Downloading and installing remote packages.
Environment for /home/visceria/projects/wes/envs/maf.yaml created (location: .snakemake/conda/184134a0b3b9725167b2eabb3f93bd3f_)
Using shell: /usr/bin/bash
Provided cores: 4
Rules claiming more threads will be scaled down.
Job stats:
job                 count
----------------  -------
all                     1
bqsr                    2
bwa_index               1
bwa_mem                 2
fastp                   2
filter_mutect           1
haplotype_caller        1
manta_sv                1
mark_duplicates         2
multiqc                 1
mutect2                 1
samtools_stats          2
vcf2maf                 1
vep_annotate            1
total                  19

Select jobs to execute...

[Thu Jan  8 00:31:53 2026]
rule fastp:
    input: data/fastq/Tumor_R1.fastq.gz, data/fastq/Tumor_R2.fastq.gz
    output: results/trimmed/Tumor_1000G_L001_R1.fastq.gz, results/trimmed/Tumor_1000G_L001_R2.fastq.gz, results/qc/fastp/Tumor_1000G_L001.json, results/qc/fastp/Tumor_1000G_L001.html
    jobid: 3
    reason: Missing output files: results/trimmed/Tumor_1000G_L001_R2.fastq.gz, results/trimmed/Tumor_1000G_L001_R1.fastq.gz, results/qc/fastp/Tumor_1000G_L001.json
    wildcards: sample=Tumor_1000G, lane=L001
    threads: 4
    resources: tmpdir=/tmp, mem_mb=4000, mem_mib=3815

[Thu Jan  8 00:33:42 2026]
Finished job 3.
1 of 19 steps (5%) done
Select jobs to execute...

[Thu Jan  8 00:33:42 2026]
rule fastp:
    input: data/fastq/Normal_R1.fastq.gz, data/fastq/Normal_R2.fastq.gz
    output: results/trimmed/Normal_1000G_L001_R1.fastq.gz, results/trimmed/Normal_1000G_L001_R2.fastq.gz, results/qc/fastp/Normal_1000G_L001.json, results/qc/fastp/Normal_1000G_L001.html
    jobid: 2
    reason: Missing output files: results/qc/fastp/Normal_1000G_L001.json, results/trimmed/Normal_1000G_L001_R1.fastq.gz, results/trimmed/Normal_1000G_L001_R2.fastq.gz
    wildcards: sample=Normal_1000G, lane=L001
    threads: 4
    resources: tmpdir=/tmp, mem_mb=4000, mem_mib=3815

[Thu Jan  8 00:35:31 2026]
Finished job 2.
2 of 19 steps (11%) done
Select jobs to execute...

[Thu Jan  8 00:35:31 2026]
rule bwa_index:
    input: data/refs/Homo_sapiens_assembly38.fasta
    output: data/refs/Homo_sapiens_assembly38.fasta.amb, data/refs/Homo_sapiens_assembly38.fasta.ann, data/refs/Homo_sapiens_assembly38.fasta.bwt, data/refs/Homo_sapiens_assembly38.fasta.pac, data/refs/Homo_sapiens_assembly38.fasta.sa
    jobid: 6
    reason: Missing output files: data/refs/Homo_sapiens_assembly38.fasta.sa, data/refs/Homo_sapiens_assembly38.fasta.pac, data/refs/Homo_sapiens_assembly38.fasta.amb, data/refs/Homo_sapiens_assembly38.fasta.ann, data/refs/Homo_sapiens_assembly38.fasta.bwt
    resources: tmpdir=/tmp, mem_mb=16000, mem_mib=15259

[Thu Jan  8 01:08:35 2026]
Finished job 6.
3 of 19 steps (16%) done
Select jobs to execute...

[Thu Jan  8 01:08:35 2026]
rule bwa_mem:
    input: results/trimmed/Normal_1000G_L001_R1.fastq.gz, results/trimmed/Normal_1000G_L001_R2.fastq.gz, data/refs/Homo_sapiens_assembly38.fasta, data/refs/Homo_sapiens_assembly38.fasta.amb, data/refs/Homo_sapiens_assembly38.fasta.ann, data/refs/Homo_sapiens_assembly38.fasta.bwt, data/refs/Homo_sapiens_assembly38.fasta.pac, data/refs/Homo_sapiens_assembly38.fasta.sa
    output: results/mapped/Normal_1000G_L001.sorted.bam
    jobid: 5
    reason: Missing output files: results/mapped/Normal_1000G_L001.sorted.bam; Input files updated by another job: data/refs/Homo_sapiens_assembly38.fasta.pac, data/refs/Homo_sapiens_assembly38.fasta.amb, results/trimmed/Normal_1000G_L001_R2.fastq.gz, data/refs/Homo_sapiens_assembly38.fasta.ann, results/trimmed/Normal_1000G_L001_R1.fastq.gz, data/refs/Homo_sapiens_assembly38.fasta.bwt, data/refs/Homo_sapiens_assembly38.fasta.sa
    wildcards: sample=Normal_1000G, lane=L001
    threads: 4
    resources: tmpdir=/tmp, mem_mb=8192, mem_mib=7813, time=08:00:00

[Thu Jan  8 02:15:08 2026]
Finished job 5.
4 of 19 steps (21%) done
Select jobs to execute...

[Thu Jan  8 02:15:08 2026]
rule mark_duplicates:
    input: results/mapped/Normal_1000G_L001.sorted.bam
    output: results/dedup/Normal_1000G.dedup.bam, results/qc/dedup/Normal_1000G.metrics.txt
    jobid: 4
    reason: Missing output files: results/dedup/Normal_1000G.dedup.bam, results/qc/dedup/Normal_1000G.metrics.txt; Input files updated by another job: results/mapped/Normal_1000G_L001.sorted.bam
    wildcards: sample=Normal_1000G
    resources: tmpdir=/tmp, mem_mb=6144, mem_mib=5860

[Thu Jan  8 02:24:17 2026]
Finished job 4.
5 of 19 steps (26%) done
Removing temporary output results/mapped/Normal_1000G_L001.sorted.bam.
Select jobs to execute...

[Thu Jan  8 02:24:17 2026]
rule samtools_stats:
    input: results/dedup/Normal_1000G.dedup.bam
    output: results/qc/bam/Normal_1000G.stats
    jobid: 9
    reason: Missing output files: results/qc/bam/Normal_1000G.stats; Input files updated by another job: results/dedup/Normal_1000G.dedup.bam
    wildcards: sample=Normal_1000G
    resources: tmpdir=/tmp


[Thu Jan  8 02:24:17 2026]
rule bqsr:
    input: results/dedup/Normal_1000G.dedup.bam, data/refs/Homo_sapiens_assembly38.fasta, data/refs/dbsnp.vcf.gz
    output: results/recal/Normal_1000G.recal_data.table, results/recal/Normal_1000G.recal.bam
    jobid: 15
    reason: Missing output files: results/recal/Normal_1000G.recal.bam; Input files updated by another job: results/dedup/Normal_1000G.dedup.bam
    wildcards: sample=Normal_1000G
    resources: tmpdir=/tmp, mem_mb=4096, mem_mib=3907

[Thu Jan  8 02:26:50 2026]
Finished job 9.
6 of 19 steps (32%) done
Select jobs to execute...
[Thu Jan  8 02:53:08 2026]
Finished job 15.
7 of 19 steps (37%) done
Removing temporary output results/dedup/Normal_1000G.dedup.bam.

[Thu Jan  8 02:53:09 2026]
rule bwa_mem:
    input: results/trimmed/Tumor_1000G_L001_R1.fastq.gz, results/trimmed/Tumor_1000G_L001_R2.fastq.gz, data/refs/Homo_sapiens_assembly38.fasta, data/refs/Homo_sapiens_assembly38.fasta.amb, data/refs/Homo_sapiens_assembly38.fasta.ann, data/refs/Homo_sapiens_assembly38.fasta.bwt, data/refs/Homo_sapiens_assembly38.fasta.pac, data/refs/Homo_sapiens_assembly38.fasta.sa
    output: results/mapped/Tumor_1000G_L001.sorted.bam
    jobid: 8
    reason: Missing output files: results/mapped/Tumor_1000G_L001.sorted.bam; Input files updated by another job: data/refs/Homo_sapiens_assembly38.fasta.pac, data/refs/Homo_sapiens_assembly38.fasta.amb, data/refs/Homo_sapiens_assembly38.fasta.ann, data/refs/Homo_sapiens_assembly38.fasta.bwt, results/trimmed/Tumor_1000G_L001_R2.fastq.gz, results/trimmed/Tumor_1000G_L001_R1.fastq.gz, data/refs/Homo_sapiens_assembly38.fasta.sa
    wildcards: sample=Tumor_1000G, lane=L001
    threads: 4
    resources: tmpdir=/tmp, mem_mb=8192, mem_mib=7813, time=08:00:00

[Thu Jan  8 03:59:31 2026]
Finished job 8.
8 of 19 steps (42%) done
Select jobs to execute...

[Thu Jan  8 03:59:31 2026]
rule mark_duplicates:
    input: results/mapped/Tumor_1000G_L001.sorted.bam
    output: results/dedup/Tumor_1000G.dedup.bam, results/qc/dedup/Tumor_1000G.metrics.txt
    jobid: 7
    reason: Missing output files: results/dedup/Tumor_1000G.dedup.bam, results/qc/dedup/Tumor_1000G.metrics.txt; Input files updated by another job: results/mapped/Tumor_1000G_L001.sorted.bam
    wildcards: sample=Tumor_1000G
    resources: tmpdir=/tmp, mem_mb=6144, mem_mib=5860


[Thu Jan  8 03:59:31 2026]
rule haplotype_caller:
    input: results/recal/Normal_1000G.recal.bam, data/refs/Homo_sapiens_assembly38.fasta, data/refs/intervals.bed
    output: results/vcf/germline/Normal_1000G.germline.vcf.gz
    jobid: 16
    reason: Missing output files: results/vcf/germline/Normal_1000G.germline.vcf.gz; Input files updated by another job: results/recal/Normal_1000G.recal.bam
    wildcards: sample=Normal_1000G
    resources: tmpdir=/tmp, mem_mb=8192, mem_mib=7813

[Thu Jan  8 04:08:10 2026]
Finished job 7.
9 of 19 steps (47%) done
Removing temporary output results/mapped/Tumor_1000G_L001.sorted.bam.
Select jobs to execute...

[Thu Jan  8 04:08:11 2026]
rule samtools_stats:
    input: results/dedup/Tumor_1000G.dedup.bam
    output: results/qc/bam/Tumor_1000G.stats
    jobid: 10
    reason: Missing output files: results/qc/bam/Tumor_1000G.stats; Input files updated by another job: results/dedup/Tumor_1000G.dedup.bam
    wildcards: sample=Tumor_1000G
    resources: tmpdir=/tmp


[Thu Jan  8 04:08:11 2026]
rule bqsr:
    input: results/dedup/Tumor_1000G.dedup.bam, data/refs/Homo_sapiens_assembly38.fasta, data/refs/dbsnp.vcf.gz
    output: results/recal/Tumor_1000G.recal_data.table, results/recal/Tumor_1000G.recal.bam
    jobid: 14
    reason: Missing output files: results/recal/Tumor_1000G.recal.bam; Input files updated by another job: results/dedup/Tumor_1000G.dedup.bam
    wildcards: sample=Tumor_1000G
    resources: tmpdir=/tmp, mem_mb=4096, mem_mib=3907

[Thu Jan  8 04:10:35 2026]
Finished job 10.
10 of 19 steps (53%) done
Select jobs to execute...

[Thu Jan  8 04:10:35 2026]
rule multiqc:
    input: results/qc/fastp/Normal_1000G_L001.json, results/qc/fastp/Tumor_1000G_L001.json, results/qc/dedup/Normal_1000G.metrics.txt, results/qc/dedup/Tumor_1000G.metrics.txt, results/qc/bam/Normal_1000G.stats, results/qc/bam/Tumor_1000G.stats
    output: results/qc/multiqc_report.html
    jobid: 1
    reason: Missing output files: results/qc/multiqc_report.html; Input files updated by another job: results/qc/bam/Tumor_1000G.stats, results/qc/fastp/Normal_1000G_L001.json, results/qc/dedup/Normal_1000G.metrics.txt, results/qc/dedup/Tumor_1000G.metrics.txt, results/qc/fastp/Tumor_1000G_L001.json, results/qc/bam/Normal_1000G.stats
    resources: tmpdir=/tmp

[Thu Jan  8 04:10:37 2026]
Finished job 1.
11 of 19 steps (58%) done
[Thu Jan  8 04:35:25 2026]
Finished job 14.
12 of 19 steps (63%) done
Removing temporary output results/dedup/Tumor_1000G.dedup.bam.
Select jobs to execute...

[Thu Jan  8 04:35:25 2026]
rule mutect2:
    input: results/recal/Tumor_1000G.recal.bam, results/recal/Normal_1000G.recal.bam, data/refs/Homo_sapiens_assembly38.fasta, data/refs/intervals.bed
    output: results/vcf/somatic/raw/Tumor_1000G.somatic.vcf.gz, results/vcf/somatic/raw/Tumor_1000G.f1r2.tar.gz
    jobid: 13
    reason: Missing output files: results/vcf/somatic/raw/Tumor_1000G.somatic.vcf.gz; Input files updated by another job: results/recal/Tumor_1000G.recal.bam, results/recal/Normal_1000G.recal.bam
    wildcards: sample=Tumor_1000G
    resources: tmpdir=/tmp, mem_mb=8192, mem_mib=7813

[Thu Jan  8 06:05:18 2026]
Finished job 16.
13 of 19 steps (68%) done
Select jobs to execute...
[Thu Jan  8 08:02:48 2026]
Finished job 13.
14 of 19 steps (74%) done

[Thu Jan  8 08:02:48 2026]
rule manta_sv:
    input: results/recal/Tumor_1000G.recal.bam, results/recal/Normal_1000G.recal.bam, data/refs/Homo_sapiens_assembly38.fasta
    output: results/sv/manta/Tumor_1000G/results/variants/somaticSV.vcf.gz
    jobid: 17
    reason: Missing output files: results/sv/manta/Tumor_1000G/results/variants/somaticSV.vcf.gz; Input files updated by another job: results/recal/Tumor_1000G.recal.bam, results/recal/Normal_1000G.recal.bam
    wildcards: sample=Tumor_1000G
    threads: 4
    resources: tmpdir=/tmp, mem_mb=4096, mem_mib=3907

Activating conda environment: .snakemake/conda/842c8145ab30d9f34d8150d6349fb859_
[Thu Jan  8 08:19:49 2026]
Finished job 17.
15 of 19 steps (79%) done
Select jobs to execute...

[Thu Jan  8 08:19:49 2026]
rule filter_mutect:
    input: results/vcf/somatic/raw/Tumor_1000G.somatic.vcf.gz, data/refs/Homo_sapiens_assembly38.fasta
    output: results/vcf/somatic/filtered/Tumor_1000G.somatic.filtered.vcf.gz
    jobid: 12
    reason: Missing output files: results/vcf/somatic/filtered/Tumor_1000G.somatic.filtered.vcf.gz; Input files updated by another job: results/vcf/somatic/raw/Tumor_1000G.somatic.vcf.gz
    wildcards: sample=Tumor_1000G
    resources: tmpdir=/tmp

[Thu Jan  8 08:19:56 2026]
Finished job 12.
16 of 19 steps (84%) done
Select jobs to execute...

[Thu Jan  8 08:19:56 2026]
rule vep_annotate:
    input: results/vcf/somatic/filtered/Tumor_1000G.somatic.filtered.vcf.gz, data/refs/vep_cache
    output: results/vcf/somatic/annotated/Tumor_1000G.somatic.ann.vcf.gz
    jobid: 11
    reason: Missing output files: results/vcf/somatic/annotated/Tumor_1000G.somatic.ann.vcf.gz; Input files updated by another job: results/vcf/somatic/filtered/Tumor_1000G.somatic.filtered.vcf.gz
    wildcards: sample=Tumor_1000G
    resources: tmpdir=/tmp

[Thu Jan  8 08:20:48 2026]
Finished job 11.
17 of 19 steps (89%) done
Select jobs to execute...

[Thu Jan  8 08:20:48 2026]
rule vcf2maf:
    input: results/vcf/somatic/annotated/Tumor_1000G.somatic.ann.vcf.gz, data/refs/Homo_sapiens_assembly38.fasta
    output: results/maf/Tumor_1000G.maf
    jobid: 18
    reason: Missing output files: results/maf/Tumor_1000G.maf; Input files updated by another job: results/vcf/somatic/annotated/Tumor_1000G.somatic.ann.vcf.gz; Code has changed since last execution; Software environment definition has changed since last execution
    wildcards: sample=Tumor_1000G
    resources: tmpdir=/tmp

Activating conda environment: .snakemake/conda/184134a0b3b9725167b2eabb3f93bd3f_
[Thu Jan  8 08:20:57 2026]
Finished job 18.
18 of 19 steps (95%) done
Select jobs to execute...

[Thu Jan  8 08:20:57 2026]
localrule all:
    input: results/qc/multiqc_report.html, results/vcf/somatic/annotated/Tumor_1000G.somatic.ann.vcf.gz, results/vcf/germline/Normal_1000G.germline.vcf.gz, results/sv/manta/Tumor_1000G/results/variants/somaticSV.vcf.gz, results/maf/Tumor_1000G.maf
    jobid: 0
    reason: Input files updated by another job: results/qc/multiqc_report.html, results/vcf/somatic/annotated/Tumor_1000G.somatic.ann.vcf.gz, results/maf/Tumor_1000G.maf, results/vcf/germline/Normal_1000G.germline.vcf.gz, results/sv/manta/Tumor_1000G/results/variants/somaticSV.vcf.gz
    resources: tmpdir=/tmp

[Thu Jan  8 08:20:57 2026]
Finished job 0.
19 of 19 steps (100%) done
Complete log: .snakemake/log/2026-01-08T003140.845300.snakemake.log
